import csv
from itertools import chain
import pandas as pd;
from functools import reduce


#change this part
df1 =  pd.read_table('CPIAUCNS.csv', sep=',')
df2 =  pd.read_table('CPIEDUNS.csv', sep=',')
df3 =  pd.read_table('CPIENGNS.csv', sep=',')
df4 =  pd.read_table('CPIFABNS.csv', sep=',')
df5 =  pd.read_table('CPIHOSNS.csv', sep=',')
df6 =  pd.read_table('CPILEGNS.csv', sep=',')
df7 =  pd.read_table('CPILFENS.csv', sep=',')
df8 =  pd.read_table('CPIMEDNS.csv', sep=',')
df9 =  pd.read_table('CPIOGSNS.csv', sep=',')
df10 =  pd.read_table('CPIRECNS.csv', sep=',')
df11 =  pd.read_table('CPITRNNS.csv', sep=',')
df12 =  pd.read_table('CPIUFDNS.csv', sep=',')
df13 =  pd.read_table('CUUR0000SA0R.csv', sep=',')
df14 =  pd.read_table('CUUR0000SA311.csv', sep=',')
df15 =  pd.read_table('CUUR0000SAA1.csv', sep=',')
df16 =  pd.read_table('CUUR0000SAA2.csv', sep=',')
df17 =  pd.read_table('CUUR0000SAC.csv', sep=',')
df18 =  pd.read_table('CUUR0000SACE.csv', sep=',')
df19 =  pd.read_table('CUUR0000SACL1.csv', sep=',')
df20 =  pd.read_table('CUUR0000SACL11.csv', sep=',')
df21 =  pd.read_table('CUUR0000SACL1E.csv', sep=',')
df22 =  pd.read_table('CUUR0000SAD.csv', sep=',')
df23 =  pd.read_table('CUUR0000SAE1.csv', sep=',')
df24 =  pd.read_table('CUUR0000SAE2.csv', sep=',')
df25 =  pd.read_table('CUUR0000SAE21.csv', sep=',')
df26 =  pd.read_table('CUUR0000SAF113.csv', sep=',')
df27 =  pd.read_table('CUUR0000SAF114.csv', sep=',')
df28 =  pd.read_table('CUUR0000SAF116.csv', sep=',')
df29 =  pd.read_table('CUUR0000SAG1.csv', sep=',')
df30 =  pd.read_table('CUUR0000SAH1.csv', sep=',')
df31 =  pd.read_table('CUUR0000SAH2.csv', sep=',')
df32 =  pd.read_table('CUUR0000SAH21.csv', sep=',')
df33 =  pd.read_table('CUUR0000SAH3.csv', sep=',')
df34 =  pd.read_table('CUUR0000SAM1.csv', sep=',')
df35 =  pd.read_table('CUUR0000SAM2.csv', sep=',')
df36 =  pd.read_table('CUUR0000SAN.csv', sep=',')
df37 =  pd.read_table('CUUR0000SAS.csv', sep=',')
df38 =  pd.read_table('CUUR0000SAS2RS.csv', sep=',')
df39 =  pd.read_table('CUUR0000SAS367.csv', sep=',')
df40 =  pd.read_table('CUUR0000SAS4.csv', sep=',')
df41 =  pd.read_table('CUUR0000SASL2RS.csv', sep=',')
df42 =  pd.read_table('CUUR0000SASL5.csv', sep=',')
df43 =  pd.read_table('CUUR0000SASLE.csv', sep=',')
df44 =  pd.read_table('CUUR0000SAT1.csv', sep=',')
df45 =  pd.read_table('CUUR0000SEAE.csv', sep=',')
df46 =  pd.read_table('CUUR0000SEAF.csv', sep=',')
df47 =  pd.read_table('CUUR0000SEEA.csv', sep=',')
df48 =  pd.read_table('CUUR0000SEEB.csv', sep=',')
df49 =  pd.read_table('CUUR0000SEED.csv', sep=',')
df50 =  pd.read_table('CUUR0000SEEE.csv', sep=',')
df51 =  pd.read_table('CUUR0000SEEE01.csv', sep=',')
df52 =  pd.read_table('CUUR0000SEFJ.csv', sep=',')
df53 =  pd.read_table('CUUR0000SEFP01.csv', sep=',')
df54 =  pd.read_table('CUUR0000SEFR.csv', sep=',')
df55 =  pd.read_table('CUUR0000SEFR02.csv', sep=',')
df56 =  pd.read_table('CUUR0000SEFS.csv', sep=',')
df57 =  pd.read_table('CUUR0000SEFV.csv', sep=',')
df58 =  pd.read_table('CUUR0000SEGA.csv', sep=',')
df59 =  pd.read_table('CUUR0000SEGB.csv', sep=',')
df60 =  pd.read_table('CUUR0000SEGB02.csv', sep=',')
df61 =  pd.read_table('CUUR0000SEGC.csv', sep=',')
df62 =  pd.read_table('CUUR0000SEGD.csv', sep=',')
df63 =  pd.read_table('CUUR0000SEGD03.csv', sep=',')
df64 =  pd.read_table('CUUR0000SEHA.csv', sep=',')
df65 =  pd.read_table('CUUR0000SEHB.csv', sep=',')
df66 =  pd.read_table('CUUR0000SEHC.csv', sep=',')
df67 =  pd.read_table('CUUR0000SEHC01.csv', sep=',')
df68 =  pd.read_table('CUUR0000SEHD.csv', sep=',')
df69 =  pd.read_table('CUUR0000SEHE.csv', sep=',')
df70 =  pd.read_table('CUUR0000SEHF.csv', sep=',')
df71 =  pd.read_table('CUUR0000SEHF01.csv', sep=',')
df72 =  pd.read_table('CUUR0000SEHF02.csv', sep=',')
df73 =  pd.read_table('CUUR0000SEHG.csv', sep=',')
df74 =  pd.read_table('CUUR0000SEHP.csv', sep=',')
df75 =  pd.read_table('CUUR0000SEHP04.csv', sep=',')
df76 =  pd.read_table('CUUR0000SEMC.csv', sep=',')
df77 =  pd.read_table('CUUR0000SEMC04.csv', sep=',')
df78 =  pd.read_table('CUUR0000SEMD.csv', sep=',')
df79 =  pd.read_table('CUUR0000SERA.csv', sep=',')
df80 =  pd.read_table('CUUR0000SERA02.csv', sep=',')
df81 =  pd.read_table('CUUR0000SERAC.csv', sep=',')
df82 =  pd.read_table('CUUR0000SERE01.csv', sep=',')
df83 =  pd.read_table('CUUR0000SERE03.csv', sep=',')
df84 =  pd.read_table('CUUR0000SERF01.csv', sep=',')
df85 =  pd.read_table('CUUR0000SERF03.csv', sep=',')
df86 =  pd.read_table('CUUR0000SERG02.csv', sep=',')
df87 =  pd.read_table('CUUR0000SETA.csv', sep=',')
df88 =  pd.read_table('CUUR0000SETA01.csv', sep=',')
df89 =  pd.read_table('CUUR0000SETA02.csv', sep=',')
df90 =  pd.read_table('CUUR0000SETB.csv', sep=',')
df91 =  pd.read_table('CUUR0000SETB01.csv', sep=',')
df92 =  pd.read_table('CUUR0000SETC.csv', sep=',')
df93 =  pd.read_table('CUUR0000SETD.csv', sep=',')
df94 =  pd.read_table('CUUR0000SETG.csv', sep=',')
df95 =  pd.read_table('CUUR0000SETG01.csv', sep=',')
df96 =  pd.read_table('CUUR0000SS61031.csv', sep=',')
df97 =  pd.read_table('CUUR0000SS62031.csv', sep=',')

#change this line
headercsv=pd.read_table('header.csv', sep=',')

#change this line
data_frames = [df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40,df41,df42,df43,df44,df45,df46,df47,df48,df49,df50,df51,df52,df53,df54,df55,df56,df57,df58,df59,df60,df61,df62,df63,df64,df65,df66,df67,df68,df69,df70,df71,df72,df73,df74,df75,df76,df77,df78,df79,df80,df81,df82,df83,df84,df85,df86,df87,df88,df89,df90,df91,df92,df93,df94,df95,df96,df97]


df_merged = reduce(lambda  left,right: pd.merge(left,right,on=['DATE'],how='outer'), data_frames)

new_header = headercsv.iloc[:,0] #grab the header
print(new_header)
df_merged.columns = new_header
print(df_merged)
df_merged.sort(['DATE'], ascending=[True], inplace=True)

pd.DataFrame.to_csv(df_merged, 'Merged_5_1_2017.csv', sep=',', na_rep='.', index=False)


#Carss - 2016 Rights Reserved
